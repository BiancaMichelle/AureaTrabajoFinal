<!-- Fragmento para la ventana modal de autenticación -->
<div th:fragment="auth-modal" id="authModal" class="auth-modal-overlay">

    <div class="auth-modal-container">
        <!-- Lado Izquierdo - Decorativo -->
        <div class="auth-modal-left">
            <div class="brand-container">
                <h2>Aurea</h2>
                <p>Tu plataforma de aprendizaje</p>
            </div>
        </div>

        <!-- Lado Derecho - Formularios -->
        <div class="auth-modal-right">
            <span class="close-modal" onclick="closeAuthModal()">&times;</span>

            <!-- Contenedor de Formularios (para el efecto de deslizamiento) -->
            <div class="forms-container">
                <!-- Formulario de Login -->
                <div class="form-wrapper" id="login-form">
                    <h3>Iniciar Sesión</h3>
                    <form th:action="@{/perform_login}" method="post">
                        <input type="hidden"
                            th:name="${_csrf.parameterName}"
                            th:value="${_csrf.token}"/>
                        <div class="input-group">
                            <label for="login-dni">DNI</label>
                            <input type="text" id="login-dni" name="username" required>
                        </div>
                        <div class="input-group">
                            <label for="login-password">Contraseña</label>
                            <input type="password" id="login-password" name="password" required>
                        </div>
                        <a href="#" class="forgot-password">¿Has olvidado tu contraseña?</a>
                        <button type="submit" class="auth-btn">Iniciar Sesión</button>
                    </form>
                    <p class="switch-form" id="to-register">¿No tienes una cuenta? <a href="#" onclick="toggleForms()">Regístrate</a></p>
                </div>

                <!-- Formulario de Registro -->
                <!-- Formulario de Registro -->
                <div class="form-wrapper" id="register-form" style="display: none;">
                    <h3>Registrarse</h3>
                
                    <!-- Navegación por Pasos -->
                    <div class="step-navigation">
                        <div class="step active" data-step="1">
                            <div class="step-icon">1</div>
                            <p>Datos Personales</p>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-icon">2</div>
                            <p>Domicilio</p>
                        </div>
                        <div class="step" data-step="3">
                            <div class="step-icon">3</div>
                            <p>Datos Académicos</p>
                        </div>
                    </div>
                
                    <form th:action="@{/register}" th:object="${alumno}" method="post" id="registerForm" novalidate>
                        <div class="form-scroll">
                            <!-- Paso 1: Datos Personales -->
                            <div class="form-step active" data-step="1">
                                <div class="input-group">
                                    <label for="reg-nombre">Nombre</label>
                                    <input type="text" th:field="*{nombre}" id="reg-nombre" name="nombre" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-apellido">Apellido</label>
                                    <input type="text" th:field="*{apellido}" id="reg-apellido" name="apellido" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('apellido')}" th:errors="*{apellido}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-dni">DNI</label>
                                    <input type="text" th:field="*{dni}" id="reg-dni" name="dni" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('dni')}" th:errors="*{dni}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-genero">Género</label>
                                    <select id="reg-genero" name="genero" required>
                                        <option value="" disabled selected>Selecciona tu género</option>
                                        <option value="Femenino">Femenino</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="X">X</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                    <span class="error-message" id="error-genero"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-fecha-nac">Fecha de nacimiento</label>
                                    <input type="date" th:field="*{fechaNacimiento}" id="reg-fecha-nac" name="fechaNacimiento" pattern="yyyy-MM-dd" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('fechaNacimiento')}" th:errors="*{fechaNacimiento}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-telefono">Teléfono</label>
                                    <input type="tel" th:field="*{numTelefono}" id="reg-telefono" name="telefono" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('numTelefono')}" th:errors="*{numTelefono}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-email">Correo Electrónico</label>
                                    <input type="email" th:field="*{correo}" id="reg-email" name="email" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('correo')}" th:errors="*{correo}"></span>
                                </div>
                            </div>
                
                            <!-- Paso 2: Domicilio -->
                            <div class="form-step" data-step="2">
                                <div class="input-group">
                                    <label for="reg-pais">País</label>
                                    <select id="reg-pais" th:field="*{pais.codigo}" name="pais.codigo" required>
                                        <option value="">Seleccionar país</option>
                                        <option th:each="pais : ${paises}" 
                                                th:value="${pais.codigo}" 
                                                th:text="${pais.nombre}">
                                        </option>
                                    </select>
                                    <span class="error-message" th:if="${#fields.hasErrors('pais.codigo')}" th:errors="*{pais.codigo}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-provincia">Provincia</label>
                                    <select id="reg-provincia" th:field="*{provincia.codigo}" name="provincia.codigo" required>
                                        <option value="">Seleccionar provincia</option>
                                    </select>
                                    <span class="error-message" th:if="${#fields.hasErrors('provincia.codigo')}" th:errors="*{provincia.codigo}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-ciudad">Ciudad</label>
                                    <select id="reg-ciudad" th:field="*{ciudad.id}" name="ciudad.id" required>
                                        <option value="">Seleccionar ciudad</option>
                                    </select>
                                    <span class="error-message" th:if="${#fields.hasErrors('ciudad.id')}" th:errors="*{ciudad.id}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-domicilio">Domicilio</label>
                                    <input type="text" th:field="*{domicilio}" id="reg-domicilio" name="domicilio" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('domicilio')}" th:errors="*{domicilio}"></span>
                                </div>
                            </div>
                
                            <!-- Paso 3: Datos Académicos -->
                            <div class="form-step" data-step="3">
                                <div class="input-group">
                                    <label for="reg-estudios">Últimos estudios alcanzados</label>
                                    <input type="text" th:field="*{ultimosEstudios}" id="reg-estudios" name="ultimosEstudios" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('ultimosEstudios')}" th:errors="*{ultimosEstudios}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-colegio">Colegio de egreso</label>
                                    <select th:field="*{colegioEgreso}" id="reg-colegio" name="colegioEgreso" required>
                                        <option value="">Seleccionar institución</option>
                                        <option th:each="inst : ${instituciones}" th:value="${inst.id}" th:text="${inst.nombre}"></option>
                                    </select>
                                    <span class="error-message" th:if="${#fields.hasErrors('colegioEgreso')}" th:errors="*{colegioEgreso}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-anio-egreso">Año de egreso</label>
                                    <input type="number" th:field="*{añoEgreso}" id="reg-anio-egreso" name="añoEgreso" min="1950" max="2025"/>
                                    <span class="error-message" th:if="${#fields.hasErrors('añoEgreso')}" th:errors="*{añoEgreso}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-password">Contraseña</label>
                                    <input type="password" th:field="*{contraseña}" id="reg-password" name="password" required>
                                    <span class="error-message" th:if="${#fields.hasErrors('contraseña')}" th:errors="*{contraseña}"></span>
                                </div>
                                <div class="input-group">
                                    <label for="reg-password2">Repetir Contraseña</label>
                                    <input type="password" id="reg-password2" name="confirmPassword" required>
                                    <span class="error-message" id="error-password2"></span>
                                </div>
                                <div class="input-group terms-group" style="display:flex; align-items:center; gap:8px;">
                                    <input type="checkbox" id="reg-terms" name="terms" required style="width:16px; height:16px;">
                                    <label for="reg-terms" style="margin:0;">Acepto los <a href="#" target="_blank">términos y condiciones</a></label>
                                </div>
                            </div>
                        </div>
                        <div class="step-actions">
                            <div class="action-group active" data-step="1">
                                <button type="button" class="auth-btn next-btn" onclick="nextStep(2)" style="width: 100%;">Siguiente</button>
                            </div>
                            <div class="action-group" data-step="2">
                                <button type="button" class="auth-btn prev-btn" onclick="prevStep(1)">Anterior</button>
                                <button type="button" class="auth-btn next-btn" onclick="nextStep(3)">Siguiente</button>
                            </div>
                            <div class="action-group" data-step="3">
                                <button type="button" class="auth-btn prev-btn" onclick="prevStep(2)">Anterior</button>
                                <button type="submit" class="auth-btn">Registrarse</button>
                            </div>
                        </div>
                    </form>
                    <p class="switch-form" id="to-login">¿Ya tienes una cuenta? <a href="#" onclick="toggleForms()">Inicia Sesión</a></p>
                </div>
            </div>
        </div>
    </div>
</div>

