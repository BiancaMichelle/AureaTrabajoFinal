<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="layout(styles, content)">
<head>
    <meta charset="UTF-8"/>
    <title>Reporte Institucional</title>
    <!-- CSS incrustado dinámicamente -->
    <style th:utext="${estilos}">
        /* Fallback o estilos base si no carga el externo */
        body { font-family: sans-serif; }
    </style>
    <style>
        :root {
            --primary-color: [[${colorPrimario}]];
            --secondary-color: [[${colorSecundario}]];
            --text-color: [[${colorTexto}]];
        }
        body { color: var(--text-color); }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            padding: 16px 0 12px 0;
            border-bottom: 2px solid var(--primary-color);
        }
        .header-left {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            flex: 1;
        }
        .header-right {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            min-width: 240px;
        }
        .meta-container {
            margin-top: 0;
            text-align: right;
        }
        .header-text {
            text-align: center;
        }
        .logo-box {
            width: 64px;
            height: 64px;
            border: 1px solid rgba(0, 0, 0, 0.06);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--secondary-color);
            padding: 6px;
            box-sizing: border-box;
        }
        .logo-box img {
            max-width: 54px;
            max-height: 54px;
            object-fit: contain;
        }
        .header-title {
            margin: 0;
            font-size: 20pt;
            color: var(--primary-color);
        }
        .header-brand {
            margin: 2px 0 0 0;
            font-size: 9pt;
            color: var(--text-color);
            opacity: 0.8;
        }
        .report-meta p {
            margin: 2px 0;
            color: var(--text-color);
        }
        .report-meta strong {
            color: var(--secondary-color);
        }
        .footer {
            margin-top: 24px;
            padding-top: 8px;
            border-top: 1px solid #e5e7eb;
            font-size: 9pt;
            color: var(--text-color);
            opacity: 0.8;
        }
    </style>
    <!-- Estilos específicos de la página hija -->
    <th:block th:replace="${styles}"></th:block>
</head>
<body>

    <!-- Encabezado General (Se repite o es fijo) -->
    <div class="header-container">
        <div class="header-left">
            <div class="logo-box">
                <img th:if="${logoBase64 != null}" th:src="${logoBase64}" alt="Logo" />
            </div>
            <div class="header-text">
                <h1 class="header-title" th:text="${institutoNombre}"> Aurea</h1>
                <p class="header-brand">Aurea</p>
            </div>
        </div>
        <div class="header-right">
            <div class="meta-container">
                <div class="report-meta">
                    <p><strong>Fecha de Emisión:</strong> <span th:text="${fechaEmision}">01/01/2026</span></p>
                    <p><strong>Generado por:</strong> <span th:text="${generadoPorNombre}">Sistema</span>
                        <span th:if="${generadoPorDni != null and !#strings.isEmpty(generadoPorDni)}"
                              th:text="' (DNI: ' + ${generadoPorDni} + ')'"></span>
                    </p>
                    <p><strong>Reporte ID:</strong> <span th:text="${reporteId}">#0000</span></p>
                    <div th:if="${mostrarFiscalEnHeader == true}" style="margin-top: 6px;">
                        <p th:if="${razonSocial != null and !#strings.isEmpty(razonSocial)}"><strong>Razón Social:</strong> <span th:text="${razonSocial}">-</span></p>
                        <p th:if="${cuit != null and !#strings.isEmpty(cuit)}"><strong>CUIT:</strong> <span th:text="${cuit}">-</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenido dinámico del Reporte -->
    <div th:replace="${content}">
        <p>Contenido del reporte...</p>
    </div>

    <!-- Pie de Página (Gestionado por CSS @page) -->
    <div class="footer">
        <p th:text="${institutoNombre}">Aurea</p>
    </div>
</body>
</html>
