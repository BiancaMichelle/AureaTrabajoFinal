<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/adminBase :: layout(~{::title}, ~{::main})}">
<head>
    <title>Dashboard Administrativo - Instituto Aurea</title>
</head>
<body>
<main class="main-content">
    <header class="main-header">
        <h1><i class="fas fa-tachometer-alt"></i> Dashboard Administrativo</h1>
    </header>

    <!-- KPI Cards Section -->
    <section id="kpi-section" class="kpi-grid">
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Total de Ofertas Académicas</h4>
                <p th:text="${totalOfertas}">0</p>
                <span class="kpi-subtitle">Cursos, Formaciones y Seminarios</span>
            </div>
            <i class="fas fa-graduation-cap"></i>
        </div>
        
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Ofertas Activas</h4>
                <p th:text="${ofertasActivas}">0</p>
                <span class="kpi-subtitle">En curso y disponibles</span>
            </div>
            <i class="fas fa-check-circle"></i>
        </div>
        
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Estudiantes Registrados</h4>
                <p th:text="${totalAlumnos}">0</p>
                <span class="kpi-subtitle">Alumnos activos en el sistema</span>
            </div>
            <i class="fas fa-user-graduate"></i>
        </div>
        
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Docentes Activos</h4>
                <p th:text="${totalDocentes}">0</p>
                <span class="kpi-subtitle">Profesionales educativos</span>
            </div>
            <i class="fas fa-chalkboard-teacher"></i>
        </div>
        
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Inscripciones Este Mes</h4>
                <p th:text="${inscripcionesMes ?: 0}">0</p>
                <span class="kpi-subtitle">Nuevas matriculaciones</span>
            </div>
            <i class="fas fa-user-plus"></i>
        </div>
        
        <div class="kpi-card">
            <div class="kpi-content">
                <h4>Tasa de Finalización</h4>
                <p><span th:text="${tasaFinalizacion ?: 85}">85</span>%</p>
                <span class="kpi-subtitle">Cursos completados</span>
            </div>
            <i class="fas fa-chart-line"></i>
        </div>
    </section>

    <!-- Charts Section -->
    <section id="analytics-section" class="charts-grid">
        <div class="chart-container">
            <h3><i class="fas fa-chart-pie"></i> Distribución de Ofertas Académicas</h3>
            <div class="chart-wrapper">
                <canvas id="ofertasChart"></canvas>
            </div>
            <div class="chart-stats">
                <div class="stat-item">
                    <span class="stat-label">Cursos:</span>
                    <span class="stat-value" th:text="${totalCursos ?: 0}">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Formaciones:</span>
                    <span class="stat-value" th:text="${totalFormaciones ?: 0}">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Seminarios:</span>
                    <span class="stat-value" th:text="${totalSeminarios ?: 0}">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Charlas:</span>
                    <span class="stat-value" th:text="${totalCharlas ?: 0}">0</span>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <h3><i class="fas fa-chart-bar"></i> Comparación de Usuarios</h3>
            <div class="chart-wrapper">
                <canvas id="usuariosChart"></canvas>
            </div>
            <div class="chart-stats">
                <div class="stat-item">
                    <span class="stat-label">Estudiantes:</span>
                    <span class="stat-value" th:text="${totalAlumnos}">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Docentes:</span>
                    <span class="stat-value" th:text="${totalDocentes}">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Ratio:</span>
                    <span class="stat-value" th:text="${ratioAlumnosDocentes ?: '0:1'}">0:1</span>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <h3><i class="fas fa-calendar-alt"></i> Actividad Mensual</h3>
            <div class="chart-wrapper">
                <canvas id="actividadChart"></canvas>
            </div>
        </div>
        
        <div class="chart-container">
            <h3><i class="fas fa-star"></i> Rendimiento General</h3>
            <div class="performance-metrics">
                <div class="metric-card">
                    <div class="metric-number" th:text="${promedioCalificaciones ?: 8.5}">8.5</div>
                    <div class="metric-label">Promedio de Calificaciones</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" th:text="${satisfaccionPromedio ?: 92}">92</div>
                    <div class="metric-label">% Satisfacción</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" th:text="${asistenciaPromedio ?: 87}">87</div>
                    <div class="metric-label">% Asistencia</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Actions Section -->
    <section id="actions-section" class="quick-actions">
        <h2><i class="fas fa-bolt"></i> Acciones Rápidas</h2>
        <div class="actions-grid">
            <a href="/admin/usuarios" class="action-card">
                <i class="fas fa-users"></i>
                <h4>Gestionar Usuarios</h4>
                <p>Administrar alumnos y docentes</p>
            </a>
            <a href="/admin/ofertas" class="action-card">
                <i class="fas fa-plus-circle"></i>
                <h4>Nueva Oferta</h4>
                <p>Crear curso o formación</p>
            </a>
            <a href="/admin/reportes" class="action-card">
                <i class="fas fa-file-alt"></i>
                <h4>Generar Reportes</h4>
                <p>Estadísticas y análisis</p>
            </a>
            <a href="/admin/configuracion" class="action-card">
                <i class="fas fa-cog"></i>
                <h4>Configuración</h4>
                <p>Ajustes del sistema</p>
            </a>
        </div>
    </section>

    <!-- Recent Activity Section -->
    <section id="activity-section" class="recent-activity">
        <h2><i class="fas fa-clock"></i> Actividad Reciente</h2>
        <div class="activity-list">
            <div class="activity-item" th:each="actividad : ${actividadesRecientes}">
                <div class="activity-icon">
                    <i class="fas fa-user-plus" th:if="${actividad.tipo} == 'registro'"></i>
                    <i class="fas fa-graduation-cap" th:if="${actividad.tipo} == 'inscripcion'"></i>
                    <i class="fas fa-check-circle" th:if="${actividad.tipo} == 'completado'"></i>
                </div>
                <div class="activity-content">
                    <p th:text="${actividad.descripcion}">Nueva inscripción registrada</p>
                    <span class="activity-time" th:text="${actividad.fechaHora}">Hace 2 horas</span>
                </div>
            </div>
            <!-- Fallback content if no activities -->
            <div class="activity-item" th:if="${#lists.isEmpty(actividadesRecientes)}">
                <div class="activity-icon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <div class="activity-content">
                    <p>No hay actividades recientes para mostrar</p>
                    <span class="activity-time">Sistema iniciado</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Chart.js and Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script th:inline="javascript">
        // Pass data from Thymeleaf to JavaScript
        const chartData = {
            totalCursos: /*[[${totalCursos ?: 0}]]*/ 0,
            totalFormaciones: /*[[${totalFormaciones ?: 0}]]*/ 0,
            totalSeminarios: /*[[${totalSeminarios ?: 0}]]*/ 0,
            totalCharlas: /*[[${totalCharlas ?: 0}]]*/ 0,
            totalAlumnos: /*[[${totalAlumnos}]]*/ 0,
            totalDocentes: /*[[${totalDocentes}]]*/ 0,
            actividadMensual: /*[[${actividadMensual ?: '[]'}]]*/ []
        };
    </script>
    <script th:src="@{/js/panelAdmin.js}"></script>
</main>
</body>
</html>